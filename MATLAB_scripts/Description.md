Здесь описывается настройка матлаба для работы со скриптами, а также описания самих скриптов.\

1) Цитата Влада Балаева:

* Есть 3 скрипта по извлечению признаков и меток (**extractAnagVector(подпись)**, **AnalysAnagLogSkakun1**)
Использовать так: vec=extractAnagVector(subjectPath,fmriPrefix,AnatPrefix,fmriFilePrefix,maskDir)
По идее должен выдавать матрицу (N+1)xM где N - число масок, M - число предъявлений задач.
N+1 потому что еще метка (число от 1 до 4 по числу задач)
subjectPath - папка с сессиями испытемых, fmriPrefix - префикс фМРТ директории, AnatPrefix - префикс анатомической директории, fmriFilePrefix - префикс файлов фМРТ (в нашем случае это будет ResI - так по-умолчанию назваются файлы после регрессии, maskDir - директория с масками)
Тут может быть не очевидным зачем нужно директорию с масками использовать, если мы уже все спроецировали и это отдельные файлы в папке каждого испытуемого. Так вот в папке могут быть и другие маски (например маска желудочков, используемая при регрессии), а нужно брать только те, которые есть в maskDir.

* Всего здесь есть 2 файла extractAnagVector - с подписью "MaxMin" и подписью "3". В файле с постфиксом "3" уже есть возможность подключить влияние гемодинамической функции. Для этого нужно раскомментить 17 строку. Для изменения метрики подсчета значения в маске нужно выбрать любую из 3 строк 85-87, а остальные две закомментить. 

* В файле с постфиксом "MaxMin" гемодинамическая функция не используется, и реализованы 2 метрики - max-min и среднее (строки 63, 64)


2) **regress_mot_ventr** (и вспомогательный файл **regressout_wo_ventr_job**) регрессирует от движений изображения

* Чтобы запустить регрессию, нужно в командной строке матлаба написать regress_mot_ventr(путь к папке с сессиями людей в одинарных кавычках,префикс функциональной папки в одинарных кавычках,TR,как хотите, чтобы называлась папка с регрессированными данными фМРТ в одинарных кавычках) итого 4 входных параметра. Например regress_mot_ventr('E:\control_group','REST_DF30_+_',2,'regressOfRestData')


3) **projectMasks** проецирует маски то, что называется в индивидуальное пространство

  * Чтобы запустить второй скрипт пишем  projectMasks(путь к папке с сессиями людей в одинарных кавычках,префикс функциональной папки в одинарных кавычках,префикс папки со структурными данными в одинарных кавычках и фигурных скобках,абсолютный путь к папке с масками). Например projectMasks('E:\control_group','REST_DF30_',{'T1_SAG_3D_ANATOMY_1X1X1_FAST_0002'},'C:\Users\IHNA\Documents\MATLAB\masks\')

Чтобы запустить нужно:

* Чтоб был установлен матлаб + некоторые стандартные его пакеты. Точно не знаю какие. Image Processing Toolbox и Signal Processing Toolbox полагаю.
* w Чтобы был скачен spm8 и прописан в Path. В матлабе не нужно подгружать библиотеки в каждом скрипте отдельно как в python например (import numpy например). Они подгружаются глобально. В меню есть опция set path, где нужно найти spm8 и подгрузить "with subfolders"
* Файлы, который здесь расположены, тоже должны лежать в какой-либо папке прописанной в Path. Например в папке матлаб в моих документах


Если возник вопрос, почему для структурной папки в фигурных скобках, то это сделано вот зачем:
Функциональные папки как правило имеют специфичные названия, а вот структурные нет. Отличаются только номером
Соответственно вместо префикса нужно писать название папки целиком вместе с номером, чтобы оно отличалось от других папок. Вот только если оператор томографа накосячил - номер может отличаться. У части испытуемых это может быть T1_SAG_3D_ANATOMY_1X1X1_FAST_0002 а у других T1_SAG_3D_ANATOMY_1X1X1_FAST_0003 и они не обработаются. А Фигурные скобки я сделал, чтобы можно было писать несколько вариантов названий папок с анатомией. Например так {'T1_SAG_3D_ANATOMY_1X1X1_FAST_0002', 'T1_SAG_3D_ANATOMY_1X1X1_FAST_0003'} - тогда обработаются папки и с таким названием папки и с другим. Еще бывает, что из двух анатомий снимают только одну. 

4) **wfu_to_individ_job** это вспомогательный файл для  перехода обратно к индивидуальному пространству

5) **interf_viewer_test2** это небольшая программа для визуализации значений сигнала в маске для каждой из 120 задач. .fig - это GUI, .m это сам код

6) **sizeofmasks** это программа считающая размер каждой из масок (в вокселях).

7) **outputtxtdur** - программа выводит 2 текстовых файла - время начала каждой задачи (в сканах) и длительность каждой задачи (в сканах).


В некоторых файлах возможны проблемы с кодировкой русского шрифта. Для исправления нужно будет открыть файл как текстовый документ в формате utf8 (через обычный блокнот), и сохранить его в нужном вам формате. На работоспособность это влиять не должно
